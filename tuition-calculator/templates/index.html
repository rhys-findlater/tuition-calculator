<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tuition Calculator</title>
    <meta name="description" content="Calculate UC Online tuition costs" />
    <!-- Favicon -->
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='favicon.ico') }}"
    />
    <!-- Main application stylesheet -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <!-- Global site header with logo and title -->
    <header class="header">
      <div class="header-container">
        <div class="header-subcontainer">
          <p class="header-text">Tuition Calculator</p>
        </div>
        <img
          src="{{ url_for('static', filename='images/uc-logo.png') }}"
          alt="logo"
          class="header-logo"
        />
      </div>
    </header>

    <!-- Main application content -->
    <main>
      <!-- Introductory welcome panel explaining the tool -->
      <div class="welcome-section-container">
        <div class="welcome-content">
          <div class="welcome-content-icon-container">
            <img
              src="{{ url_for('static', filename='icons/calculator.svg') }}"
              alt="Calculator icon"
              class="main-icon"
            />
            <p class="welcome-title">
              Welcome to the UC Online Tuition Calculator
            </p>
          </div>
          <p class="welcome-text">
            Select courses and learner type below to receive an accurate,
            comprehensive cost breakdown including Student Services Levy (SSL)
            and GST where applicable then export your results to PDF.
          </p>
        </div>
      </div>

      <!-- 3-column layout: learner info, cost summary, course selection + SSL -->
      <div class="main-content-container">
        <!-- Learner information card (type + location) -->
        <div class="learner-info-container">
          <div class="learner-info-header-container">
            <div class="learner-info-header-logo-container">
              <img
                src="{{ url_for('static', filename='icons/users.svg') }}"
                alt="Person icon"
                class="main-icon"
              />
              <p class="learner-info-header-text">Learner Information</p>
            </div>
            <p class="learner-info-header-text">
              Select your learner type and current location to calculate
              accurate costs
            </p>
          </div>

          <div class="learner-info-selection-container">
            <!-- Learner type radio options -->
            <div class="learner-info-select-container">
              <div class="learner-info-select-icon-container">
                <img
                  src="{{ url_for('static', filename='icons/graduation-cap.svg') }}"
                  alt="Graduation cap icon"
                  class="sub-icon"
                />
                <p class="learner-info-select-text">Learner Type</p>
              </div>
              <form
                method="post"
                action="{{ url_for('index')}}"
                aria-label="Learner type selection"
              >
                <div class="learner-info-label-container">
                  <label class="learner-info-option">
                    <input
                      class="radio-button"
                      type="radio"
                      id="domestic"
                      name="learner_type"
                      value="domestic"
                      checked
                    />
                    <span class="learner-info-text">
                      <p class="learner-info-option-text">Domestic Learner</p>
                      <p class="learner-info-option-text">
                        New Zealand citizen or resident
                      </p>
                    </span>
                  </label>

                  <label class="learner-info-option">
                    <input
                      class="radio-button"
                      type="radio"
                      id="international"
                      name="learner_type"
                      value="international"
                    />
                    <span class="learner-info-text">
                      <p class="learner-info-option-text">
                        International Learner
                      </p>
                      <p class="learner-info-option-text">
                        International Student
                      </p>
                    </span>
                  </label>
                </div>
              </form>
            </div>

            <!-- Physical location radio options (affects GST + SSL logic) -->
            <div class="learner-info-select-container">
              <div class="learner-info-select-icon-container">
                <img
                  src="{{ url_for('static', filename='icons/map-pin-black.svg') }}"
                  alt="Location pin icon"
                  class="sub-icon"
                />
                <p class="learner-info-select-text">
                  Current Physical Location
                </p>
              </div>
              <form
                method="post"
                action="{{ url_for('index')}}"
                aria-label="Learner type selection"
              >
                <label class="learner-info-option">
                  <input
                    class="radio-button"
                    type="radio"
                    id="onshore"
                    name="location"
                    value="onshore"
                    checked
                  />
                  <span class="learner-info-text">
                    <p class="learner-info-option-text">
                      Onshore (In New Zealand)
                    </p>
                    <p class="learner-info-option-text">GST applies</p>
                  </span>
                </label>

                <label class="learner-info-option">
                  <input
                    class="radio-button"
                    type="radio"
                    id="offshore"
                    name="location"
                    value="offshore"
                  />
                  <span class="learner-info-text">
                    <p class="learner-info-option-text">
                      Offshore (Outside New Zealand)
                    </p>
                    <p class="learner-info-option-text">GST does not apply</p>
                  </span>
                </label>
              </form>
            </div>
          </div>
        </div>

        <!-- Sticky cost summary column -->
        <div class="cost-summary-sticky-wrapper">
          <!-- Cost summary card (idle + active states controlled via JS) -->
          <div
            id="costSummary"
            class="cost-summary-container cost-summary-idle"
          >
            <div class="cost-summary-header-container">
              <img
                src="{{ url_for('static', filename='icons/receipt.svg') }}"
                alt="Receipt icon"
                class="main-icon"
              />
              <p class="cost-summary-header">Cost Summary</p>
            </div>
            <!-- Learner pills -->
            <div class="cost-summary-active-content" id="costSummaryActive">
              <div class="cost-summary-pills">
                <span class="cost-summary-pill">Domestic</span>
                <span class="cost-summary-pill">Onshore</span>
              </div>

              <!-- Top stats -->
              <div class="cost-summary-stats">
                <div class="cost-summary-stats-row">
                  <span>Courses selected</span>
                  <span id="costSummaryCoursesSelected">8</span>
                </div>
                <div class="cost-summary-stats-row">
                  <span>Total points</span>
                  <span id="costSummaryTotalPoints">120</span>
                </div>
              </div>

              <!-- Line items -->
              <div class="cost-summary-lines">
                <div class="cost-summary-line">
                  <span>Course fees</span>
                  <span id="costSummaryCourseFees">$9999.00</span>
                </div>

                <div class="cost-summary-line">
                  <div class="cost-summary-line-main">
                    <span>Student services levy</span>
                    <img
                      src="{{ url_for('static', filename='icons/info-grey.svg') }}"
                      alt=""
                      class="cost-summary-icon-inline"
                    />
                  </div>
                  <span id="costSummaryLevy">$999</span>
                </div>
                <p class="cost-summary-subtext" id="costSummaryLevyNote">
                  Based on 0 points
                </p>

                <div class="cost-summary-line">
                  <span>Subtotal</span>
                  <span id="costSummarySubtotal">$9999.00</span>
                </div>

                <div class="cost-summary-line">
                  <div class="cost-summary-line-main">
                    <span>GST (15%)</span>
                    <img
                      src="{{ url_for('static', filename='icons/info-grey.svg') }}"
                      alt=""
                      class="cost-summary-icon-inline"
                    />
                  </div>
                  <span id="costSummaryGst">$999</span>
                </div>
              </div>

              <!-- Total + export -->
              <div class="cost-summary-total">
                <span>Total cost</span>
                <span id="costSummaryTotal">$9999.00</span>
              </div>

              <!-- Export to PDF action (wired in app.js) -->
              <button class="cost-summary-export">
                <img
                  src="{{ url_for('static', filename='icons/download.svg') }}"
                  alt=""
                  class="cost-summary-icon-inline"
                />
                <span>Export to PDF</span>
              </button>

              <!-- Footnote -->
              <div class="cost-summary-footnotes">
                <p>* Fees are indicative and subject to change.</p>
                <p>
                  * Additional costs such as textbooks and materials may apply.
                </p>
              </div>
            </div>
            <!-- Idle state -->
            <div
              class="cost-summary-idle-container cost-summary-idle-content"
              id="costSummaryIdle"
            >
              <img
                src="{{ url_for('static', filename='icons/circle-alert.svg') }}"
                alt="Alert pin icon"
                class="cost-summary-icon"
              />
              <p class="cost-summary-text-idle">
                Select courses to see a full cost breakdown
              </p>
            </div>
          </div>
        </div>

        <!-- Course selection and search column -->
        <div class="course-selection-container">
          <div class="course-selection-heading-container">
            <div class="course-selection-heading-icon-container">
              <img
                src="{{ url_for('static', filename='icons/book-open.svg') }}"
                alt="Open book icon"
                class="main-icon"
              />
              <p class="course-selection-heading">Course Selection</p>
            </div>
            <p class="course-selection-container-text">
              Search and select courses to add to your cost calculation
            </p>
          </div>

          <!-- Selected Courses -->
          <div class="selected-courses-container">
            <div class="selected-courses-header">
              <p class="selected-courses-title">
                Selected Courses (<span id="selectedCoursesCount">0</span>)
              </p>

              <!-- Clear all selected courses (disabled when none selected) -->
              <button
                type="button"
                class="selected-courses-clear"
                id="clearSelectedCourses"
                disabled
              >
                <span class="selected-courses-clear-x">Clear All</span>
              </button>
            </div>

            <!-- Populated dynamically via JavaScript -->
            <div class="selected-courses-list" id="selectedCoursesList"></div>
          </div>
          <!-- End selected courses -->

          <!-- Course search input -->
          <div class="course-selection-search-container">
            <form
              class="course-search"
              role="search"
              aria-label="Course search"
            >
              <label for="course-search" class="course-search-label"
                >Available Courses</label
              >
              <input
                id="course-search"
                class="search-input"
                name="q"
                type="search"
                placeholder="Search by course code or title..."
              />
            </form>
          </div>

          <!-- Faculty filter pills (All Faculties + dynamic list) -->
          <div class="course-selection-degree-filter">
            <button class="course-degree-filter" data-faculty="All Faculties">
              All Faculties
            </button>
            {% for faculty in unique_faculties %}
            <button class="course-degree-filter" data-faculty="{{ faculty }}">
              <span class="course-degree-filter-label">{{ faculty }}</span>
            </button>
            {% endfor %}
          </div>

          <!-- Course results list rendered from SharePoint/Excel data -->
          <div class="course-selection-course-list">
            {% for course in courses %}
            <div
              class="course-selection-course"
              data-course-code="{{ course['UC Code'] }}"
              data-course-title="{{ course['Course Title'] }}"
              data-course-points="{{ course['Points'] }}"
              data-dom-price="{{ course['Dom Fees - 2026'] }}"
              data-int-price="{{ course['Int Fees - 2026'] }}"
              data-course-price="{{ course['Dom Fees - 2026'] }}"
              data-course-faculty="{{ course['Faculty'] }}"
            >
              <div class="course-selection-course-info-container">
                <div class="course-selection-course-code-container">
                  <p>{{ course['UC Code'] }}</p>
                  <p class="course-selection-course-degree">
                    {{ course['Faculty'] }}
                  </p>
                  {% if course['Points'] == 'TBC' %}
                  <p class="course-selection-course-points">
                    {{ course['Points'] }}
                  </p>
                  {% else %} {% set p = course['Points']|float %}
                  <!-- Render whole numbers without decimal, otherwise show full value -->
                  <p class="course-selection-course-points">
                    {{ (p|int) if p == (p|int) else p }} pts
                  </p>
                  {% endif %}
                </div>
                <p>{{ course['Course Title'] }}</p>
              </div>
              <div class="course-selection-course-button-container">
                <p>${{ "%.2f"|format(course['Dom Fees - 2026']) }}</p>
                <!-- Toggle button used by JS to add/remove course from selection -->
                <button
                  class="course-selection-course-button"
                  type="button"
                  data-course-toggle
                >
                  <span class="course-selection-course-button-add">+</span>
                  <span class="course-selection-course-button-label">Add</span>
                </button>
              </div>
            </div>
            {% endfor %}
          </div>

          <!-- Pagination/visibility controls for long course lists -->
          <button id="showAllCourses" class="course-degree-showall">
            Show all courses
          </button>
          <button
            id="showLessCourses"
            style="display: none"
            class="course-degree-showless"
            disabled
          >
            Show less courses
          </button>
        </div>

        <!-- Student Services Levy explanation panel -->
        <div class="ssl-container">
          <div class="ssl-container-header">
            <div class="ssl-container-header-row">
              <div class="ssl-container-icon-wrapper">
                <img
                  src="{{ url_for('static', filename='icons/info.svg') }}"
                  alt="Information"
                  class="main-icon"
                />
              </div>
              <div>
                <p class="ssl-container-title">
                  Student Services Levy (SSL) 2025
                </p>
                <p class="ssl-container-subtitle">
                  Charged per academic point, based on your physical location
                </p>
              </div>
            </div>
          </div>
          <div class="ssl-container-content">
            <!-- On-campus (Onshore) reference panel (kept as commented example)
            <div class="ssl-panel-onshore">
              <div class="ssl-panel-header">
                <div class="ssl-panel-icon-wrapper">
                  <img
                    src="{{ url_for('static', filename='icons/map-pin.svg') }}"
                    alt="On-campus location"
                    class="sub-icon"
                  />
                </div>
                <div class="ssl-panel-header-text">
                  <p class="ssl-panel-title">On-campus (Onshore)</p>
                  <p class="ssl-panel-subtitle">Site codes: C, M, A</p>
                </div>
              </div>

              <div class="ssl-panel-rows">
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">One 15-point course</p>
                  <p class="ssl-panel-value">$145.80</p>
                </div>
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">One semester (60 points)</p>
                  <p class="ssl-panel-value">$583.20</p>
                </div>
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">Two semesters (120 points)</p>
                  <p class="ssl-panel-value">$1166.40</p>
                </div>
              </div>
            </div>
            -->
            <!-- Off-campus (Offshore) -->
            <div class="ssl-panel-offshore">
              <div class="ssl-panel-header">
                <div class="ssl-panel-icon-wrapper">
                  <img
                    src="{{ url_for('static', filename='icons/globe.svg') }}"
                    alt="Off-campus location"
                    class="sub-icon"
                  />
                </div>
                <div class="ssl-panel-header-text">
                  <p class="ssl-panel-title">Off-campus (Offshore)</p>
                  <p class="ssl-panel-subtitle">Site codes: D, O, E, N, F</p>
                </div>
              </div>

              <div class="ssl-panel-rows">
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">One 15-point course</p>
                  <p class="ssl-panel-value">$29.10</p>
                </div>
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">One semester (60 points)</p>
                  <p class="ssl-panel-value">$116.40</p>
                </div>
                <div class="ssl-panel-row">
                  <p class="ssl-panel-label">Two semesters (120 points)</p>
                  <p class="ssl-panel-value">$232.80</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Global footer -->
    <footer class="footer">
      <p class="footer-text">
        UC Online Course Costing Application | UC Online
      </p>
    </footer>
    <!-- Main application script (handles selection, filtering, and cost logic) -->
    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
